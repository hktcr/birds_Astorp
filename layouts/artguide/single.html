{{ define "main" }}
<div class="artguide">
    <!-- Progress bar -->
    <div class="artguide-progress" role="progressbar" aria-valuemin="0" aria-valuemax="150" aria-valuenow="0"
        aria-label="Årslista framsteg">
        <div class="artguide-progress__bar">
            <div class="artguide-progress__fill"></div>
            <div class="artguide-progress__milestones">
                <span class="artguide-progress__milestone" style="left: 33.3%">50</span>
                <span class="artguide-progress__milestone" style="left: 66.6%">100</span>
                <span class="artguide-progress__milestone" style="left: 100%">150</span>
            </div>
        </div>
        <div class="artguide-progress__text">
            <span class="artguide-progress__count">0/150 arter</span>
            <span class="artguide-progress__latest"></span>
        </div>
    </div>

    <!-- Month navigation -->
    <nav class="artguide-months" aria-label="Välj månad">
        <button class="artguide-months__btn" data-month="0">Jan</button>
        <button class="artguide-months__btn" data-month="1">Feb</button>
        <button class="artguide-months__btn" data-month="2">Mar</button>
        <button class="artguide-months__btn" data-month="3">Apr</button>
        <button class="artguide-months__btn" data-month="4">Maj</button>
        <button class="artguide-months__btn" data-month="5">Jun</button>
        <button class="artguide-months__btn" data-month="6">Jul</button>
        <button class="artguide-months__btn" data-month="7">Aug</button>
        <button class="artguide-months__btn" data-month="8">Sep</button>
        <button class="artguide-months__btn" data-month="9">Okt</button>
        <button class="artguide-months__btn" data-month="10">Nov</button>
        <button class="artguide-months__btn" data-month="11">Dec</button>
    </nav>

    <!-- View toggle + filters -->
    <div class="artguide-controls">
        <div class="artguide-view-toggle" role="tablist" aria-label="Växla vy">
            <button class="artguide-view-toggle__btn artguide-view-toggle__btn--active" data-view="month" role="tab"
                aria-selected="true">Månadsvy</button>
            <button class="artguide-view-toggle__btn" data-view="year" role="tab"
                aria-selected="false">Helårsöversikt</button>
        </div>
        <div class="artguide-sort-toggle" aria-label="Sortering">
            <button class="artguide-sort__btn artguide-sort__btn--active" data-sort="likely">Troligast</button>
            <button class="artguide-sort__btn" data-sort="chronological">Kronologisk</button>
            <button class="artguide-sort__btn" data-sort="taxonomy">Taxonomisk</button>
        </div>
        <div class="artguide-filters">
            <!-- Category pills with integrated legend -->
            <div class="artguide-filters__categories" role="group" aria-label="Filtrera efter kategori">
                <button class="artguide-cat-pill artguide-cat-pill--abundant" data-filter="abundant"
                    aria-pressed="false" aria-label="Filtrera förväntade arter">
                    <span class="artguide-cat-pill__header">
                        <span class="artguide-cat-pill__icon">●</span>
                        <span class="artguide-cat-pill__name">Förväntade</span>
                    </span>
                    <span class="artguide-cat-pill__count" id="count-abundant">0</span>
                    <span class="artguide-cat-pill__progress" role="progressbar" aria-valuenow="0" aria-valuemin="0"
                        aria-valuemax="100">
                        <span class="artguide-cat-pill__progress-fill"></span>
                    </span>
                </button>
                <button class="artguide-cat-pill artguide-cat-pill--regular" data-filter="regular" aria-pressed="false"
                    aria-label="Filtrera möjliga arter">
                    <span class="artguide-cat-pill__header">
                        <span class="artguide-cat-pill__icon">○</span>
                        <span class="artguide-cat-pill__name">Möjliga</span>
                    </span>
                    <span class="artguide-cat-pill__count" id="count-regular">0</span>
                    <span class="artguide-cat-pill__progress" role="progressbar" aria-valuenow="0" aria-valuemin="0"
                        aria-valuemax="100">
                        <span class="artguide-cat-pill__progress-fill"></span>
                    </span>
                </button>
                <button class="artguide-cat-pill artguide-cat-pill--uncommon" data-filter="uncommon"
                    aria-pressed="false" aria-label="Filtrera ovanliga arter">
                    <span class="artguide-cat-pill__header">
                        <span class="artguide-cat-pill__icon">◆</span>
                        <span class="artguide-cat-pill__name">Ovanliga</span>
                    </span>
                    <span class="artguide-cat-pill__count" id="count-uncommon">0</span>
                    <span class="artguide-cat-pill__progress" role="progressbar" aria-valuenow="0" aria-valuemin="0"
                        aria-valuemax="100">
                        <span class="artguide-cat-pill__progress-fill"></span>
                    </span>
                </button>
                <button class="artguide-cat-pill artguide-cat-pill--rare" data-filter="rare" aria-pressed="false"
                    aria-label="Filtrera rariteter">
                    <span class="artguide-cat-pill__header">
                        <span class="artguide-cat-pill__icon">⭐</span>
                        <span class="artguide-cat-pill__name">Rariteter</span>
                    </span>
                    <span class="artguide-cat-pill__count" id="count-rare">0</span>
                    <span class="artguide-cat-pill__progress" role="progressbar" aria-valuenow="0" aria-valuemin="0"
                        aria-valuemax="100">
                        <span class="artguide-cat-pill__progress-fill"></span>
                    </span>
                </button>
                <button class="artguide-filters__reset" aria-label="Nollställ filter"
                    style="visibility: hidden; opacity: 0;">✕</button>
            </div>
            <!-- Meta filters as text links -->
            <div class="artguide-filters__meta">
                <button class="artguide-meta-link" data-filter="checked">Kryssade ✓</button>
                <span class="artguide-meta-sep">·</span>
                <button class="artguide-meta-link" data-filter="missing">Saknade</button>
                <span class="artguide-meta-sep">·</span>
                <span class="artguide-meta-total" id="legend-count-total"></span>
            </div>
        </div>
    </div>

    <!-- Month view heading -->
    <div class="artguide-month-heading">
        <h2 class="artguide-month-heading__title"></h2>
        <p class="artguide-month-heading__subtitle"></p>
        <p class="artguide-month-heading__description" id="artguide-description"></p>
    </div>

    <!-- Species container (filled by JS) -->
    <div class="artguide-species" id="artguide-species"></div>

    <!-- Footer -->
    <footer class="artguide-footer">
        <p>Data: <a href="https://www.artportalen.se" target="_blank" rel="noopener">Artportalen</a> — samtliga
            fågelobservationer i Åstorps kommun, alla observatörer, alla år.</p>
        <p class="artguide-footer__date"></p>
    </footer>
</div>
{{ end }}

{{ define "scripts" }}
<script>
    window.siteBaseURL = '{{ .Site.BaseURL }}';
</script>
{{ $js := resources.Get "js/artguide.js" | fingerprint }}
<script src="{{ $js.RelPermalink }}"></script>
{{ end }}