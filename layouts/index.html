{{ define "main" }}
<!-- RSPB-inspired Hero with full-width image -->
<section class="hero-rspb">
    <div class="hero-image-container">
        <img src="{{ `images/hero-red-kite.png` | relURL }}" alt="R√∂d glada √∂ver √Östorps landskap"
            class="hero-bg-image">
        <div class="hero-overlay"></div>
    </div>

    <div class="hero-content-box">
        <h1>F√•gel√•ret i √Östorp</h1>
        <p>Uppt√§ck f√•gellivet i kommunen med 1298 observerade r√∂da glador och rariteter som svart stork.</p>
        <a href="{{ `arslista/` | relURL }}" class="hero-cta">Se √•rslistan 2026 ‚Üí</a>
    </div>

    <!-- Floating progress card -->
    <div class="progress-card">
        <div class="progress-header">
            <span class="progress-label">√Örsm√•l 2026</span>
            <span class="progress-count"><span id="species-count">‚Äî</span> / 130</span>
        </div>
        <div class="progress-bar-mini">
            <div class="progress-fill-mini" id="progress-fill"></div>
        </div>
        <div class="progress-milestones">
            <span>ü•â 100</span>
            <span>ü•à 125</span>
            <span>ü•á 150</span>
        </div>
    </div>
</section>

<!-- Featured species section -->
<section class="featured-species">
    <div class="container">
        <h2 class="section-title">Utvalda arter</h2>
        <div class="species-feature-grid">

            <article class="feature-card feature-card-large">
                <img src="{{ `images/little-ringed-plover.png` | relURL }}" alt="Mindre strandpipare" loading="lazy">
                <div class="feature-content">
                    <span class="feature-tag">Kommunf√•gel</span>
                    <h3>Mindre strandpipare</h3>
                    <p>√Östorps officiella kommunf√•gel med sin karakteristiska gula √∂gonring. H√§ckar vid grusmarker och
                        str√§nder.</p>
                    <a href="#" class="feature-link">L√§s mer ‚Üí</a>
                </div>
            </article>

            <article class="feature-card">
                <img src="{{ `images/white-stork.png` | relURL }}" alt="Vit stork" loading="lazy">
                <div class="feature-content">
                    <span class="feature-tag">Klassisk</span>
                    <h3>Vit stork</h3>
                    <p>293 observationer i kommunen. H√§ckar p√• S√∂der√•sen.</p>
                </div>
            </article>

            <article class="feature-card">
                <img src="{{ `images/fieldfare.png` | relURL }}" alt="Bj√∂rktrast" loading="lazy">
                <div class="feature-content">
                    <span class="feature-tag">Vinter</span>
                    <h3>Bj√∂rktrast</h3>
                    <p>Vanlig vinterg√§st i stora flockar p√• √Östorps f√§lt.</p>
                </div>
            </article>

        </div>
    </div>
</section>

<!-- Latest observations -->
<section class="latest-observations">
    <div class="container">
        <div class="section-header">
            <h2 class="section-title">Senaste observationerna</h2>
            <a href="{{ `arkiv/` | relURL }}" class="view-all">Visa alla ‚Üí</a>
        </div>

        <div class="posts-grid-rspb">
            {{ $posts := where .Site.RegularPages "Section" "posts" }}
            {{ range first 3 $posts }}
            <article class="post-card-rspb">
                {{ with .Params.image }}
                <img src="{{ . | relURL }}" alt="{{ $.Title }}" class="post-image" loading="lazy">
                {{ else }}
                <div class="post-image-placeholder-rspb">
                    <img src="{{ `images/wetland-sunrise.png` | relURL }}" alt="V√•tmark" loading="lazy">
                </div>
                {{ end }}
                <div class="post-content-rspb">
                    <span class="post-category">{{ with .Params.location }}{{ . }}{{ else }}Observation{{ end }}</span>
                    <h3><a href="{{ .Permalink }}">{{ .Title }}</a></h3>
                    <time datetime="{{ .Date.Format `2006-01-02` }}">{{ .Date.Format "2 januari 2006" }}</time>
                </div>
            </article>
            {{ end }}
        </div>
    </div>
</section>

<!-- Quick links section -->
<section class="explore-section">
    <div class="container">
        <h2 class="section-title">Utforska</h2>
        <div class="explore-grid">
            <a href="{{ `arslista/` | relURL }}" class="explore-card">
                <div class="explore-icon">üìã</div>
                <h3>√Örslista 2026</h3>
                <p>Interaktiv krysslista med <span id="total-species">78</span> arter att jaga</p>
            </a>
            <a href="{{ `karta/` | relURL }}" class="explore-card">
                <div class="explore-icon">üó∫Ô∏è</div>
                <h3>Karta</h3>
                <p>Se observationsplatser i kommunen</p>
            </a>
            <a href="{{ `om/` | relURL }}" class="explore-card">
                <div class="explore-icon">üê¶</div>
                <h3>Om projektet</h3>
                <p>L√§r k√§nna √Östorps f√•gelliv</p>
            </a>
        </div>
    </div>
</section>
{{ end }}

{{ define "scripts" }}
<script>
    const YEAR_GOAL = 130;

    fetch('{{ `data/checklist-2026.json` | relURL }}')
        .then(r => r.json())
        .then(data => {
            const uniqueSpecies = new Set(data.observations.map(o => o.species));
            const speciesCount = uniqueSpecies.size;

            // Update all stats
            document.querySelectorAll('#species-count').forEach(el => el.textContent = speciesCount);

            // Update progress bar
            const percentage = Math.min((speciesCount / YEAR_GOAL) * 100, 100);
            const fill = document.getElementById('progress-fill');
            if (fill) {
                fill.style.width = percentage + '%';
                if (speciesCount >= 150) fill.style.background = 'linear-gradient(90deg, #ffd700, #ffb700)';
                else if (speciesCount >= 125) fill.style.background = 'linear-gradient(90deg, #c0c0c0, #a0a0a0)';
                else if (speciesCount >= 100) fill.style.background = 'linear-gradient(90deg, #cd7f32, #b87333)';
            }
        })
        .catch(console.error);
</script>
{{ end }}